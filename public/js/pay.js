// Generated by CoffeeScript 1.4.0
(function() {
  var publicStripeApiKey, publicStripeApiKeyTesting, stripeResponseHandler;

  publicStripeApiKey = '...';

  publicStripeApiKeyTesting = 'pk_test_wWU1d0rrwxxxe8KjW9OCzf7c';

  Stripe.setPublishableKey(publicStripeApiKeyTesting);

  stripeResponseHandler = function(status, response) {
    var form$, token;
    if (response.error) {
      $(".payment-errors").text(response.error.message);
      return $(".submit-button").removeAttr("disabled");
    } else {
      form$ = $("#payment-form");
      token = response['id'];
      form$.append("<input type='hidden' name='stripeToken' id='stripeToken' value='" + token + "' />");
      return form$.get(0).submit();
    }
  };

  $(document).ready(function() {
    return $("#payment-form").submit(function(event) {
      $('.submit-button').attr("disabled", "disabled");
      Stripe.createToken({
        number: $('.card-number').val(),
        cvc: $('.card-cvc').val(),
        exp_month: $('.card-expiry-month').val(),
        exp_year: $('.card-expiry-year').val()
      }, stripeResponseHandler);
      return false;
    });
  });

}).call(this);
